<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Bajere" />
  <meta name="theme-color" content="#0a0a0f" />
  <meta name="format-detection" content="telephone=no" />
  <title>Hvor mange genstande?</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold: #d4af37;
      --gold-light: #f4d03f;
      --gold-dark: #b8860b;
      --bg: #0a0a0f;
      --text: #ffffff;
      --text-sub: rgba(255,255,255,0.65);
      --text-muted: rgba(255,255,255,0.4);
      --border: rgba(212,175,55,0.22);
      --glass: rgba(255,255,255,0.055);
      --glass-border: rgba(255,255,255,0.1);
      --success: #34c759;
    }

    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

    html, body {
      height: 100%;
      overflow: hidden;
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', -apple-system, system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      touch-action: manipulation;
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* â”€â”€ Background â”€â”€ */
    .bg-glow {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background:
        radial-gradient(ellipse 70% 50% at 20% 10%, rgba(212,175,55,.09) 0%, transparent 70%),
        radial-gradient(ellipse 60% 60% at 80% 90%, rgba(212,175,55,.06) 0%, transparent 70%);
      animation: glowShift 18s ease-in-out infinite alternate;
    }
    @keyframes glowShift {
      0%   { opacity: 1; transform: scale(1) translate(0,0); }
      100% { opacity: .8; transform: scale(1.08) translate(1%, 1.5%); }
    }

    /* â”€â”€ Top bar (dots + lock) â”€â”€ */
    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: calc(12px + env(safe-area-inset-top)) 20px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 200;
      opacity: 0;
      transition: opacity .3s;
      pointer-events: none;
    }
    .top-bar.visible { opacity: 1; pointer-events: auto; }

    .dots {
      display: flex;
      gap: 10px;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .dot {
      width: 10px; height: 10px;
      border-radius: 50%;
      background: var(--glass-border);
      transition: all .3s cubic-bezier(.4,0,.2,1);
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .dot:active { transform: scale(1.5); }
    .dot.active {
      background: var(--gold);
      box-shadow: 0 0 12px var(--gold);
      transform: scale(1.2);
    }
    .dot.done { background: rgba(212,175,55,.5); }

    .lock-btn {
      width: 40px; height: 40px;
      border-radius: 50%;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all .2s;
      -webkit-tap-highlight-color: transparent;
    }
    .lock-btn:active {
      transform: scale(.92);
      background: rgba(212,175,55,.15);
      border-color: var(--gold);
      color: var(--gold);
    }

    .spacer { width: 40px; }

    /* â”€â”€ Screen container â”€â”€ */
    .screens {
      position: fixed; inset: 0; z-index: 10;
      overflow: hidden;
    }

    /* â”€â”€ Each screen â”€â”€ */
    .screen {
      position: absolute; inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: calc(80px + env(safe-area-inset-top)) 28px calc(28px + env(safe-area-inset-bottom));
      transform: translateX(100%);
      opacity: 0;
      pointer-events: none;
      will-change: transform, opacity;
    }
    .screen.slide-in {
      transition: transform .5s cubic-bezier(.32,.72,0,1), opacity .5s cubic-bezier(.32,.72,0,1);
      transform: translateX(0);
      opacity: 1;
      pointer-events: auto;
    }
    .screen.slide-out-left {
      transition: transform .4s cubic-bezier(.4,0,.6,1), opacity .4s cubic-bezier(.4,0,.6,1);
      transform: translateX(-30%);
      opacity: 0;
      pointer-events: none;
    }
    .screen.slide-out-right {
      transition: transform .4s cubic-bezier(.4,0,.6,1), opacity .4s cubic-bezier(.4,0,.6,1);
      transform: translateX(100%);
      opacity: 0;
      pointer-events: none;
    }
    .screen.enter-from-left {
      transform: translateX(-30%);
      opacity: 0;
    }

    /* â”€â”€ Screen layout: content at top, actions at bottom â”€â”€ */
    .screen-top {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      max-width: 380px;
      margin: 0 auto;
      width: 100%;
    }
    .screen-bottom {
      max-width: 380px;
      margin: 0 auto;
      width: 100%;
      padding-top: 20px;
    }

    /* Stagger entrance */
    .screen.slide-in .screen-top > *,
    .screen.slide-in .screen-bottom > * {
      animation: fadeUp .5s cubic-bezier(.22,.68,0,1.1) both;
    }
    .screen.slide-in .screen-top > *:nth-child(1) { animation-delay: .06s; }
    .screen.slide-in .screen-top > *:nth-child(2) { animation-delay: .12s; }
    .screen.slide-in .screen-top > *:nth-child(3) { animation-delay: .18s; }
    .screen.slide-in .screen-top > *:nth-child(4) { animation-delay: .24s; }
    .screen.slide-in .screen-top > *:nth-child(5) { animation-delay: .30s; }
    .screen.slide-in .screen-bottom > * { animation-delay: .32s; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* â”€â”€ Icon â”€â”€ */
    .icon {
      width: 72px; height: 72px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      margin-bottom: 24px;
      display: flex; align-items: center; justify-content: center;
      font-size: 36px;
      box-shadow: 0 8px 32px rgba(212,175,55,.3);
    }

    /* â”€â”€ Typography â”€â”€ */
    .title {
      font-family: 'Playfair Display', serif;
      font-size: 32px;
      font-weight: 600;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #fff 0%, var(--gold-light) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle {
      font-size: 16px;
      color: var(--text-sub);
      margin-bottom: 32px;
      line-height: 1.5;
      font-weight: 400;
      max-width: 300px;
    }

    /* â”€â”€ Inputs â”€â”€ */
    .field-wrap { margin-bottom: 16px; width: 100%; }
    .field-label {
      display: block;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
    }
    .field {
      width: 100%;
      padding: 20px 24px;
      font-size: 32px;
      font-weight: 600;
      font-family: 'Inter', sans-serif;
      text-align: center;
      background: var(--glass);
      border: 2px solid var(--border);
      border-radius: 20px;
      color: var(--text);
      outline: none;
      transition: all .25s cubic-bezier(.4,0,.2,1);
      -webkit-appearance: none;
    }
    .field::placeholder { color: var(--text-muted); font-weight: 400; }
    .field:focus {
      border-color: var(--gold);
      box-shadow: 0 0 0 4px rgba(212,175,55,.12), 0 8px 32px rgba(212,175,55,.15);
      background: rgba(255,255,255,.06);
      transform: scale(1.02);
    }
    .hint { font-size: 13px; color: var(--text-muted); margin-top: 12px; }

    .two-col { display: flex; gap: 16px; width: 100%; }
    .two-col .field-wrap { flex: 1; margin-bottom: 0; }
    .two-col .field { font-size: 28px; padding: 18px 16px; }

    .food-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; margin-bottom: 12px; }
    .food-cell {
      background: var(--glass);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 14px 10px 12px;
      transition: all .25s;
    }
    .food-cell:focus-within {
      border-color: var(--gold);
      transform: scale(1.02);
      box-shadow: 0 4px 20px rgba(212,175,55,.15);
    }
    .food-cell label {
      display: block;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: .6px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 6px;
    }
    .food-cell input {
      width: 100%;
      background: transparent;
      border: none;
      font-size: 28px;
      font-weight: 600;
      font-family: 'Inter', sans-serif;
      color: var(--text);
      text-align: center;
      outline: none;
      -webkit-appearance: none;
    }
    .food-cell input::placeholder { color: var(--text-muted); font-weight: 400; }

    .small-field { font-size: 24px !important; padding: 14px 16px !important; }

    /* â”€â”€ Selection cards (gender / weight) â”€â”€ */
    .pick-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; width: 100%; }
    .pick-list   { display: flex; flex-direction: column; gap: 12px; width: 100%; }

    .pick-card {
      background: var(--glass);
      border: 2px solid var(--border);
      border-radius: 20px;
      padding: 22px 16px;
      text-align: center;
      cursor: pointer;
      transition: all .2s cubic-bezier(.4,0,.2,1);
      -webkit-tap-highlight-color: transparent;
      position: relative;
      overflow: hidden;
    }
    .pick-card:active {
      transform: scale(.96);
      border-color: var(--gold);
      background: rgba(212,175,55,.12);
    }
    .pick-card.selected {
      border-color: var(--gold);
      background: rgba(212,175,55,.14);
      box-shadow: 0 0 0 4px rgba(212,175,55,.12);
    }
    .pick-card-icon { font-size: 32px; margin-bottom: 10px; line-height: 1; }
    .pick-card-label {
      font-size: 17px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }
    .pick-card-sub {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
    }
    /* Horizontal list variant */
    .pick-list .pick-card {
      display: flex;
      align-items: center;
      text-align: left;
      padding: 18px 20px;
      gap: 16px;
      border-radius: 16px;
    }
    .pick-list .pick-card-icon { font-size: 26px; margin-bottom: 0; flex-shrink: 0; }
    .pick-list .pick-card-text { flex: 1; }
    .pick-list .pick-card-check {
      width: 22px; height: 22px;
      border-radius: 50%;
      border: 2px solid var(--border);
      flex-shrink: 0;
      transition: all .2s;
      display: flex; align-items: center; justify-content: center;
    }
    .pick-list .pick-card.selected .pick-card-check {
      background: var(--gold);
      border-color: var(--gold);
    }
    .pick-list .pick-card.selected .pick-card-check::after {
      content: '';
      width: 6px; height: 10px;
      border: 2px solid var(--bg);
      border-top: none; border-left: none;
      transform: rotate(45deg) translate(-1px,-1px);
      display: block;
    }

    /* â”€â”€ Buttons â”€â”€ */
    .btn {
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: 18px;
      border: none;
      border-radius: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 18px 24px;
      -webkit-appearance: none;
      transition: transform .15s cubic-bezier(.4,0,.2,1), box-shadow .15s;
      position: relative;
      overflow: hidden;
    }
    /* Ripple effect */
    .btn::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), rgba(255,255,255,.3) 0%, transparent 60%);
      opacity: 0;
      transition: opacity .4s;
    }
    .btn:active::after { opacity: 1; }
    .btn:active { transform: scale(.97); }

    .btn-gold {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      color: var(--bg);
      box-shadow: 0 6px 24px rgba(212,175,55,.35);
    }
    .btn-gold:active { box-shadow: 0 2px 12px rgba(212,175,55,.25); }

    .btn-ghost {
      background: var(--glass);
      border: 2px solid var(--glass-border);
      color: var(--text-sub);
    }
    .btn-ghost:active {
      border-color: var(--gold);
      background: rgba(212,175,55,.1);
    }

    .btn-row { display: flex; gap: 12px; }
    .btn-row .btn-gold { flex: 1; }
    .btn-back {
      flex: none !important;
      width: 60px !important;
      padding: 0 !important;
      font-size: 20px;
    }

    /* â”€â”€ Error â”€â”€ */
    .err {
      color: #ff6b72;
      font-size: 14px;
      margin-top: 16px;
      display: none;
      animation: shake .5s ease;
    }
    .err.show { display: block; }
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20%,60%  { transform: translateX(-8px); }
      40%,80%  { transform: translateX(8px); }
    }

    /* â”€â”€ Invalid field â”€â”€ */
    .field.invalid, .food-cell.invalid {
      border-color: #ff6b72 !important;
      box-shadow: 0 0 0 4px rgba(255,107,114,.15) !important;
      animation: shake .5s ease;
    }

    /* â”€â”€ Result screen â”€â”€ */
    .result-num {
      font-family: 'Playfair Display', serif;
      font-size: 120px;
      font-weight: 700;
      line-height: 1;
      margin-bottom: 0;
      background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .result-unit { font-size: 24px; color: var(--text-sub); margin-bottom: 20px; }
    .result-raw { font-size: 13px; color: var(--text-muted); margin-bottom: 16px; }

    /* Confetti burst */
    .confetti-container {
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translateX(-50%);
      pointer-events: none;
      z-index: 300;
    }
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 2px;
      opacity: 0;
    }
    .confetti.burst {
      animation: confettiFall 1.5s cubic-bezier(.25,.46,.45,.94) forwards;
    }
    @keyframes confettiFall {
      0% { opacity: 1; transform: translate(0, 0) rotate(0deg) scale(1); }
      100% { opacity: 0; transform: translate(var(--tx), var(--ty)) rotate(720deg) scale(0); }
    }

    /* Tier badge */
    .tier-badge {
      background: linear-gradient(135deg, rgba(212,175,55,.15) 0%, rgba(212,175,55,.05) 100%);
      border: 1.5px solid var(--border);
      border-radius: 16px;
      padding: 18px 24px;
      margin-bottom: 24px;
      width: 100%;
    }
    .tier-label {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 6px;
    }
    .tier-name {
      font-size: 20px;
      font-weight: 700;
      color: var(--gold-light);
      margin-bottom: 8px;
    }
    .tier-desc {
      font-size: 14px;
      font-style: italic;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .result-btn-row {
      display: flex;
      gap: 12px;
    }
    .result-btn-row .btn-gold {
      flex: 1;
    }
    .btn-share {
      flex: none;
      width: 60px;
      padding: 0;
      background: var(--glass);
      border: 2px solid var(--glass-border);
      color: var(--text-sub);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 16px;
      cursor: pointer;
      transition: all .2s;
      -webkit-tap-highlight-color: transparent;
    }
    .btn-share:active {
      background: rgba(212,175,55,.15);
      border-color: var(--gold);
      color: var(--gold);
      transform: scale(.95);
    }

    .edit-link {
      margin-top: 20px;
      font-size: 15px;
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 12px 20px;
      border-radius: 12px;
      transition: all .2s;
    }
    .edit-link:active {
      background: var(--glass);
      color: var(--gold);
    }

    /* â”€â”€ Modal â”€â”€ */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.6);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      z-index: 500;
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s;
    }
    .modal-overlay.show { opacity: 1; pointer-events: auto; }

    .modal {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(180deg, #1a1a24 0%, #0d0d12 100%);
      border-radius: 24px 24px 0 0;
      padding: 16px 24px calc(20px + env(safe-area-inset-bottom));
      z-index: 501;
      transform: translateY(100%);
      transition: transform .4s cubic-bezier(.32,.72,0,1);
      max-height: 85vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }
    .modal-overlay.show .modal { transform: translateY(0); }

    .modal-handle {
      width: 36px;
      height: 5px;
      background: rgba(255,255,255,.25);
      border-radius: 3px;
      margin: 0 auto 16px;
    }
    .modal-title {
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      font-weight: 600;
      text-align: center;
      margin-bottom: 20px;
      color: var(--gold-light);
    }

    .step-list { display: flex; flex-direction: column; gap: 10px; }
    .step-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 18px 20px;
      background: var(--glass);
      border: 1.5px solid var(--border);
      border-radius: 16px;
      cursor: pointer;
      transition: all .2s;
      -webkit-tap-highlight-color: transparent;
    }
    .step-item:active {
      transform: scale(.98);
      border-color: var(--gold);
      background: rgba(212,175,55,.1);
    }
    .step-icon {
      font-size: 26px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(212,175,55,.12);
      border-radius: 14px;
    }
    .step-info { flex: 1; text-align: left; }
    .step-name { font-size: 16px; font-weight: 500; color: var(--text); }
    .step-value { font-size: 13px; color: var(--text-muted); margin-top: 3px; }
    .step-arrow { color: var(--text-muted); font-size: 20px; }

    .modal-close {
      margin-top: 16px;
      padding: 18px;
      width: 100%;
      background: transparent;
      border: 2px solid var(--glass-border);
      border-radius: 14px;
      color: var(--text-sub);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all .2s;
    }
    .modal-close:active { border-color: var(--gold); }

    /* â”€â”€ Swipe hint â”€â”€ */
    .swipe-hint {
      position: fixed;
      bottom: calc(20px + env(safe-area-inset-bottom));
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      color: var(--text-muted);
      background: var(--glass);
      padding: 10px 18px;
      border-radius: 20px;
      z-index: 200;
      opacity: 0;
      transition: opacity .4s;
      pointer-events: none;
    }
    .swipe-hint.show { opacity: 1; }

    audio { display: none; }

    /* â”€â”€ Responsive â”€â”€ */
    @media (max-height: 700px) {
      .icon { width: 60px; height: 60px; font-size: 28px; margin-bottom: 18px; }
      .title { font-size: 26px; }
      .subtitle { font-size: 14px; margin-bottom: 24px; }
      .field { padding: 16px 20px; font-size: 26px; }
      .result-num { font-size: 90px; }
    }
    @media (max-height: 600px) {
      .icon { width: 50px; height: 50px; font-size: 24px; margin-bottom: 14px; }
      .title { font-size: 22px; }
      .subtitle { font-size: 13px; margin-bottom: 18px; }
      .field { padding: 14px 16px; font-size: 22px; }
      .result-num { font-size: 70px; }
      .btn { padding: 16px 20px; font-size: 16px; }
    }
  </style>
</head>
<body>
  <div class="bg-glow"></div>
  <audio id="unlockSound" src="shitbro.mp3" preload="auto"></audio>

  <!-- Top bar -->
  <div class="top-bar" id="topBar">
    <div class="spacer"></div>
    <div class="dots" id="dots">
      <div class="dot" data-step="gender"></div>
      <div class="dot" data-step="weight"></div>
      <div class="dot" data-step="1"></div>
      <div class="dot" data-step="2"></div>
      <div class="dot" data-step="3"></div>
      <div class="dot" data-step="4"></div>
      <div class="dot" data-step="5"></div>
    </div>
    <button class="lock-btn" id="lockBtn" aria-label="LÃ¥s">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
        <rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>
      </svg>
    </button>
  </div>

  <!-- Swipe hint -->
  <div class="swipe-hint" id="swipeHint">â† Swipe eller tryk dots â†’</div>

  <!-- Confetti container -->
  <div class="confetti-container" id="confetti"></div>

  <!-- Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal" id="stepModal">
      <div class="modal-handle" id="modalHandle"></div>
      <h2 class="modal-title">Ret dine svar</h2>
      <div class="step-list" id="stepList">
        <div class="step-item" data-goto="1">
          <div class="step-icon">ğŸ»</div>
          <div class="step-info">
            <div class="step-name">Alkoholprocent</div>
            <div class="step-value" id="val-vol">Ikke udfyldt</div>
          </div>
          <div class="step-arrow">â€º</div>
        </div>
        <div class="step-item" data-goto="2">
          <div class="step-icon">â°</div>
          <div class="step-info">
            <div class="step-name">MÃ¸detid</div>
            <div class="step-value" id="val-time">Ikke udfyldt</div>
          </div>
          <div class="step-arrow">â€º</div>
        </div>
        <div class="step-item" data-goto="3">
          <div class="step-icon">ğŸ˜´</div>
          <div class="step-info">
            <div class="step-name">SÃ¸vn</div>
            <div class="step-value" id="val-sleep">Ikke udfyldt</div>
          </div>
          <div class="step-arrow">â€º</div>
        </div>
        <div class="step-item" data-goto="4">
          <div class="step-icon">ğŸ–</div>
          <div class="step-info">
            <div class="step-name">Mad</div>
            <div class="step-value" id="val-food">Ikke udfyldt</div>
          </div>
          <div class="step-arrow">â€º</div>
        </div>
        <div class="step-item" data-goto="5">
          <div class="step-icon">ğŸ’§</div>
          <div class="step-info">
            <div class="step-name">Vand</div>
            <div class="step-value" id="val-water">Ikke udfyldt</div>
          </div>
          <div class="step-arrow">â€º</div>
        </div>
      </div>
      <button class="modal-close" id="modalClose">Annuller</button>
    </div>
  </div>

  <div class="screens">

    <!-- LOGIN -->
    <div class="screen slide-in" id="s-login">
      <div class="screen-top">
        <div class="icon">ğŸº</div>
        <h1 class="title">Dav Fyr</h1>
        <p class="subtitle">Indtast din adgangskode for at fortsÃ¦tte</p>
        <div class="field-wrap">
          <input class="field" type="password" id="pw" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="off" enterkeyhint="go" />
        </div>
        <p class="err" id="pwErr">Forkert adgangskode</p>
      </div>
      <div class="screen-bottom">
        <button class="btn btn-gold" id="unlockBtn">LÃ¥s op</button>
      </div>
    </div>

    <!-- GENDER -->
    <div class="screen" id="s-gender">
      <div class="screen-top">
        <div class="icon">ğŸ‘¤</div>
        <h1 class="title">Hvilket kÃ¸n er du?</h1>
        <p class="subtitle">Det pÃ¥virker dit anbefalede antal genstande</p>
        <div class="pick-grid-2">
          <div class="pick-card" id="pick-mand" data-gender="mand">
            <div class="pick-card-icon">ğŸ§”</div>
            <div class="pick-card-label">Mand</div>
          </div>
          <div class="pick-card" id="pick-kvinde" data-gender="kvinde">
            <div class="pick-card-icon">ğŸ‘©</div>
            <div class="pick-card-label">Kvinde</div>
          </div>
        </div>
      </div>
      <div class="screen-bottom">
        <button class="btn btn-gold" id="n-gender" disabled style="opacity:.4">NÃ¦ste</button>
      </div>
    </div>

    <!-- WEIGHT -->
    <div class="screen" id="s-weight">
      <div class="screen-top">
        <div class="icon">âš–ï¸</div>
        <h1 class="title">Hvad vejer du?</h1>
        <p class="subtitle">VÃ¦lg den kategori der passer bedst</p>
        <div class="pick-list" id="weightList">
          <div class="pick-card" data-weight="0.80">
            <div class="pick-card-icon">ğŸª¶</div>
            <div class="pick-card-text">
              <div class="pick-card-label">55â€“65 kg</div>
              <div class="pick-card-sub">MÃ¦rker alkohol hurtigt</div>
            </div>
            <div class="pick-card-check"></div>
          </div>
          <div class="pick-card" data-weight="1.00">
            <div class="pick-card-icon">ğŸ§</div>
            <div class="pick-card-text">
              <div class="pick-card-label">70â€“80 kg</div>
              <div class="pick-card-sub">Gennemsnitlig tÃ¦rskel</div>
            </div>
            <div class="pick-card-check"></div>
          </div>
          <div class="pick-card" data-weight="1.15">
            <div class="pick-card-icon">ğŸ’ª</div>
            <div class="pick-card-text">
              <div class="pick-card-label">80â€“90 kg</div>
              <div class="pick-card-sub">Over gennemsnittet</div>
            </div>
            <div class="pick-card-check"></div>
          </div>
          <div class="pick-card" data-weight="1.30">
            <div class="pick-card-icon">ğŸ‹ï¸</div>
            <div class="pick-card-text">
              <div class="pick-card-label">100â€“115 kg</div>
              <div class="pick-card-sub">HÃ¸j kropsvÃ¦gt</div>
            </div>
            <div class="pick-card-check"></div>
          </div>
          <div class="pick-card" data-weight="1.50">
            <div class="pick-card-icon">ğŸ¦£</div>
            <div class="pick-card-text">
              <div class="pick-card-label">115+ kg</div>
              <div class="pick-card-sub">Meget hÃ¸j kropsvÃ¦gt</div>
            </div>
            <div class="pick-card-check"></div>
          </div>
        </div>
      </div>
      <div class="screen-bottom">
        <div class="btn-row">
          <button class="btn btn-ghost btn-back" id="b-weight">â€¹</button>
          <button class="btn btn-gold" id="n-weight" disabled style="opacity:.4">NÃ¦ste</button>
        </div>
      </div>
    </div>

    <!-- 1: Vol% -->
    <div class="screen" id="s-1">
      <div class="screen-top">
        <div class="icon">ğŸ»</div>
        <h1 class="title">Alkohol%</h1>
        <p class="subtitle">Hvad er den gennemsnitlige Vol% pÃ¥ det du drikker?</p>
        <div class="field-wrap">
          <input class="field" id="vol" type="text" inputmode="decimal" placeholder="5.0" enterkeyhint="next" />
          <p class="hint">F.eks. 4.6 for en klassisk pilsner</p>
        </div>
      </div>
      <div class="screen-bottom">
        <button class="btn btn-gold" id="n1">NÃ¦ste</button>
      </div>
    </div>

    <!-- 2: MÃ¸detid -->
    <div class="screen" id="s-2">
      <div class="screen-top">
        <div class="icon">â°</div>
        <h1 class="title">MÃ¸detid</h1>
        <p class="subtitle">HvornÃ¥r skal du mÃ¸de ind i morgen?</p>
        <div class="two-col">
          <div class="field-wrap">
            <label class="field-label">Time</label>
            <input class="field" id="ath" type="text" inputmode="numeric" placeholder="9" enterkeyhint="next" />
          </div>
          <div class="field-wrap">
            <label class="field-label">Minut</label>
            <input class="field" id="atm" type="text" inputmode="numeric" placeholder="00" enterkeyhint="next" />
          </div>
        </div>
      </div>
      <div class="screen-bottom">
        <div class="btn-row">
          <button class="btn btn-ghost btn-back" id="b2">â€¹</button>
          <button class="btn btn-gold" id="n2">NÃ¦ste</button>
        </div>
      </div>
    </div>

    <!-- 3: SÃ¸vn -->
    <div class="screen" id="s-3">
      <div class="screen-top">
        <div class="icon">ğŸ˜´</div>
        <h1 class="title">SÃ¸vn</h1>
        <p class="subtitle">Hvor mange timer regner du med at sove?</p>
        <div class="field-wrap">
          <input class="field" id="sleep" type="text" inputmode="decimal" placeholder="7" enterkeyhint="next" />
          <p class="hint">Timer fra du gÃ¥r i seng til du stÃ¥r op</p>
        </div>
      </div>
      <div class="screen-bottom">
        <div class="btn-row">
          <button class="btn btn-ghost btn-back" id="b3">â€¹</button>
          <button class="btn btn-gold" id="n3">NÃ¦ste</button>
        </div>
      </div>
    </div>

    <!-- 4: Mad -->
    <div class="screen" id="s-4">
      <div class="screen-top">
        <div class="icon">ğŸ–</div>
        <h1 class="title">Mad</h1>
        <p class="subtitle">Hvad har du spist i dag?</p>
        <div class="food-grid">
          <div class="food-cell">
            <label>KÃ¸d</label>
            <input id="meat" type="text" inputmode="decimal" placeholder="0" />
          </div>
          <div class="food-cell">
            <label>BrÃ¸d</label>
            <input id="bread" type="text" inputmode="decimal" placeholder="0" />
          </div>
          <div class="food-cell">
            <label>GrÃ¸nt</label>
            <input id="greens" type="text" inputmode="decimal" placeholder="0" />
          </div>
          <div class="food-cell">
            <label>Frugt</label>
            <input id="fruit" type="text" inputmode="decimal" placeholder="0" />
          </div>
        </div>
        <div class="field-wrap">
          <label class="field-label">Flydende kost</label>
          <input class="field small-field" id="liquid" type="text" inputmode="decimal" placeholder="0" enterkeyhint="next" />
        </div>
      </div>
      <div class="screen-bottom">
        <div class="btn-row">
          <button class="btn btn-ghost btn-back" id="b4">â€¹</button>
          <button class="btn btn-gold" id="n4">NÃ¦ste</button>
        </div>
      </div>
    </div>

    <!-- 5: Vand -->
    <div class="screen" id="s-5">
      <div class="screen-top">
        <div class="icon">ğŸ’§</div>
        <h1 class="title">Vand</h1>
        <p class="subtitle">Hvor mange glas vand drikker du i aften?</p>
        <div class="field-wrap">
          <input class="field" id="water" type="text" inputmode="decimal" placeholder="0" enterkeyhint="done" />
          <p class="hint">1 glas â‰ˆ 200 ml</p>
        </div>
      </div>
      <div class="screen-bottom">
        <div class="btn-row">
          <button class="btn btn-ghost btn-back" id="b5">â€¹</button>
          <button class="btn btn-gold" id="n5">Beregn ğŸº</button>
        </div>
      </div>
    </div>

    <!-- RESULT -->
    <div class="screen" id="s-result">
      <div class="screen-top">
        <div class="icon" id="resultIcon">ğŸ‰</div>
        <div class="result-num" id="resNum">0</div>
        <div class="result-unit">genstande</div>
        <div class="result-raw" id="resRaw"></div>
        <div class="tier-badge">
          <div class="tier-label">Bajer Score:</div>
          <div class="tier-name" id="tierName">-</div>
          <div class="tier-desc" id="tierDesc">-</div>
        </div>
      </div>
      <div class="screen-bottom">
        <div class="result-btn-row">
          <button class="btn btn-gold" id="restartBtn">PrÃ¸v igen</button>
          <button class="btn btn-share" id="shareBtn" aria-label="Del resultat">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
              <polyline points="16 6 12 2 8 6"/>
              <line x1="12" y1="2" x2="12" y2="15"/>
            </svg>
          </button>
        </div>
        <div class="edit-link" id="editBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Ret mine svar
        </div>
      </div>
    </div>

  </div>

  <script>
  (() => {
    const PASS = "bajerforfandenda";
    const KEY  = "hobby_calc_unlocked";
    const ORDER = ['login','gender','weight','1','2','3','4','5','result'];
    let current = 'login';
    let modalDragY = 0;
    let selectedGender = null;   // 'mand' | 'kvinde'
    let selectedWeight = 1.00;   // multiplier
    let weightChosen   = false;

    const $ = id => document.getElementById(id);

    // â”€â”€ Haptic feedback (if supported) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function haptic(style = 'light') {
      if ('vibrate' in navigator) {
        navigator.vibrate(style === 'heavy' ? 20 : 10);
      }
    }

    // â”€â”€ Tiers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const TIERS = [
      { max: 1,  icon: 'ğŸ‘¶', name: 'Infant', desc: 'Bruh bare bliv hjemme, hvad fanden laver du ude?' },
      { max: 4,  icon: 'ğŸ’ª', name: 'Gym-bro', desc: 'Respekt for at du passer pÃ¥ din krop bro' },
      { max: 5,  icon: 'ğŸ˜', name: 'Just a regular type dude', desc: 'Fed indstilling' },
      { max: 7,  icon: 'ğŸ·', name: 'Experienced alcoholic', desc: 'Du er sÃ¥ cool man' },
      { max: 9,  icon: 'ğŸ’Š', name: 'Antabus-tier', desc: 'Enten er du arbejdslÃ¸s eller bare en funktionel alkoholiker' },
      { max: Infinity, icon: 'ğŸ¦‡', name: "Glostrups Batman", desc: 'Du er udÃ¸delig og sÃ¥ lÃ¦kker altsÃ¥' }
    ];
    function getTier(n) {
      for (const t of TIERS) if (n <= t.max) return t;
      return TIERS[TIERS.length - 1];
    }

    // â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function parseNum(v) {
      const s = String(v ?? '').trim().replace(/\s+/g,'').replace(',','.');
      if (!s) return null;
      const n = Number(s);
      return isFinite(n) ? n : null;
    }
    function roundHalf(x) {
      if (!isFinite(x)) return NaN;
      return x >= 0 ? Math.floor(x + .5) : Math.ceil(x - .5);
    }

    // â”€â”€ Calculation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function calc() {
      const vRaw = parseNum($('vol').value) || 0;
      const ath = parseNum($('ath').value) || 0;
      const atm = parseNum($('atm').value) || 0;
      const sleep = parseNum($('sleep').value) || 0;
      const meat = parseNum($('meat').value) || 0;
      const bread = parseNum($('bread').value) || 0;
      const greens = parseNum($('greens').value) || 0;
      const fruit = parseNum($('fruit').value) || 0;
      const liquid = parseNum($('liquid').value) || 0;
      const water = parseNum($('water').value) || 0;

      const v = vRaw > 1 ? vRaw / 100 : vRaw;
      if (v <= 0) return { result: 0, raw: 0 };

      const D7 = .06 / v;
      const F10 = ((ath - 9) + 1 - 1) + atm/60;
      const B8 = (5 + F10) + (sleep - 7) / 2;
      const K8 = (meat-1) + (bread*.2-1) + (greens*.15-1) + (fruit*.1-1) + (liquid*.2-1);
      const B11 = (B8 + K8 + (water/3 - 1)) * D7 * selectedWeight;

      return { result: roundHalf(B11), raw: Math.round(B11 * 100) / 100 };
    }

    // â”€â”€ Confetti burst â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function confetti() {
      const container = $('confetti');
      container.innerHTML = '';
      const colors = ['#d4af37', '#f4d03f', '#fff', '#b8860b', '#34c759'];
      for (let i = 0; i < 30; i++) {
        const el = document.createElement('div');
        el.className = 'confetti';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.setProperty('--tx', (Math.random() - 0.5) * 300 + 'px');
        el.style.setProperty('--ty', Math.random() * 200 + 100 + 'px');
        el.style.left = (Math.random() - 0.5) * 100 + 'px';
        container.appendChild(el);
        setTimeout(() => el.classList.add('burst'), i * 20);
      }
    }

    // â”€â”€ Animated counter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function animateNumber(el, target) {
      const duration = 1000;
      const start = performance.now();
      function frame(now) {
        const t = Math.min((now - start) / duration, 1);
        const ease = 1 - Math.pow(1 - t, 4);
        el.textContent = Math.round(target * ease);
        if (t < 1) requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    }

    // â”€â”€ Screen transition â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function go(to, dir = 'forward') {
      if (to === current) return;
      haptic();
      document.activeElement?.blur();

      const fromEl = $('s-' + current);
      const toEl = $('s-' + to);

      [fromEl, toEl].forEach(e => {
        e.classList.remove('slide-in','slide-out-left','slide-out-right','enter-from-left');
      });

      if (dir === 'forward') {
        fromEl.classList.add('slide-out-left');
        toEl.classList.add('slide-in');
      } else {
        fromEl.classList.add('slide-out-right');
        toEl.classList.add('enter-from-left');
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            toEl.classList.remove('enter-from-left');
            toEl.classList.add('slide-in');
          });
        });
      }

      current = to;
      updateChrome();

      // Auto-focus
      setTimeout(() => {
        const inp = toEl.querySelector('input');
        if (inp && to !== 'login' && to !== 'result') inp.focus();
      }, 450);
    }

    // â”€â”€ Chrome (dots) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function updateChrome() {
      const topBar = $('topBar');
      const hint   = $('swipeHint');
      const curIdx = ORDER.indexOf(current);  // position in ORDER

      topBar.classList.toggle('visible', current !== 'login');

      if (current === 'gender') {
        hint.classList.add('show');
        setTimeout(() => hint.classList.remove('show'), 2500);
      }

      document.querySelectorAll('.dot').forEach(d => {
        const dotIdx = ORDER.indexOf(d.dataset.step);
        d.classList.remove('active','done');
        if (current === 'result') d.classList.add('done');
        else if (dotIdx === curIdx)  d.classList.add('active');
        else if (dotIdx < curIdx)    d.classList.add('done');
      });
    }

    // â”€â”€ Dot navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.querySelectorAll('.dot').forEach(d => {
      d.addEventListener('click', () => {
        if (current === 'login') return;
        const target = d.dataset.step;
        const curIdx = ORDER.indexOf(current);
        const targetIdx = ORDER.indexOf(target);
        if (targetIdx < curIdx) {
          go(target, 'back');
        } else if (targetIdx > curIdx) {
          // Validate current screen before jumping forward
          $('n' + current)?.click();
        }
      });
    });

    // â”€â”€ Swipe â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let touchX0 = null, touchY0 = null, swiping = false;
    document.addEventListener('touchstart', e => {
      touchX0 = e.touches[0].clientX;
      touchY0 = e.touches[0].clientY;
      swiping = false;
    }, { passive: true });
    document.addEventListener('touchmove', e => {
      if (touchX0 === null) return;
      const dx = e.touches[0].clientX - touchX0;
      const dy = e.touches[0].clientY - touchY0;
      if (!swiping && Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 12) swiping = true;
    }, { passive: true });
    document.addEventListener('touchend', e => {
      if (!swiping || touchX0 === null) { touchX0 = null; return; }
      const dx = e.changedTouches[0].clientX - touchX0;
      touchX0 = null; swiping = false;
      if (current === 'login') return;
      if (document.activeElement?.tagName === 'INPUT') return;
      const idx = ORDER.indexOf(current);
      if (dx < -60 && idx < ORDER.length - 2 && current !== 'result') $('n' + current)?.click();
      else if (dx > 60 && idx > 1) go(ORDER[idx - 1], 'back');
    });

    // â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openModal() {
      haptic();
      const vol = $('vol').value, ath = $('ath').value, atm = $('atm').value || '00';
      const sleep = $('sleep').value, water = $('water').value;
      const meat = $('meat').value, bread = $('bread').value;

      $('val-vol').textContent = vol ? vol + ' %' : 'Ikke udfyldt';
      $('val-time').textContent = ath ? `Kl. ${ath}:${atm.padStart(2,'0')}` : 'Ikke udfyldt';
      $('val-sleep').textContent = sleep ? sleep + ' timer' : 'Ikke udfyldt';
      $('val-food').textContent = (meat && meat !== '0') || (bread && bread !== '0') ? 'Udfyldt' : 'Ikke udfyldt';
      $('val-water').textContent = water && water !== '0' ? water + ' glas' : 'Ikke udfyldt';

      $('modalOverlay').classList.add('show');
    }
    function closeModal() {
      $('modalOverlay').classList.remove('show');
    }

    // Pull-down to dismiss modal
    let modalTouchY = null;
    $('stepModal').addEventListener('touchstart', e => {
      modalTouchY = e.touches[0].clientY;
    }, { passive: true });
    $('stepModal').addEventListener('touchmove', e => {
      if (modalTouchY === null) return;
      const dy = e.touches[0].clientY - modalTouchY;
      if (dy > 0) {
        $('stepModal').style.transform = `translateY(${dy}px)`;
      }
    }, { passive: true });
    $('stepModal').addEventListener('touchend', e => {
      if (modalTouchY === null) return;
      const dy = e.changedTouches[0].clientY - modalTouchY;
      modalTouchY = null;
      if (dy > 100) {
        closeModal();
      }
      $('stepModal').style.transform = '';
    });

    document.querySelectorAll('.step-item').forEach(item => {
      item.addEventListener('click', () => {
        haptic();
        const target = item.dataset.goto;
        closeModal();
        setTimeout(() => go(target, 'back'), 280);
      });
    });
    $('modalClose').onclick = closeModal;
    $('modalOverlay').addEventListener('click', e => {
      if (e.target === $('modalOverlay')) closeModal();
    });

    // â”€â”€ Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function tryUnlock() {
      const ok = $('pw').value === PASS;
      $('pwErr').classList.toggle('show', !ok);
      if (!ok) { haptic('heavy'); return; }
      haptic();
      try {
        const s = $('unlockSound');
        s.loop = true; s.currentTime = 0; s.play();
      } catch(_) {}
      localStorage.setItem(KEY, '1');
      go('gender', 'forward');
    }
    function lock() {
      haptic();
      localStorage.removeItem(KEY);
      ORDER.forEach(id => {
        const e = $('s-' + id);
        if (e) e.classList.remove('slide-in','slide-out-left','slide-out-right','enter-from-left');
      });
      selectedGender = null; selectedWeight = 1.00; weightChosen = false;
      document.querySelectorAll('[data-gender]').forEach(c => c.classList.remove('selected'));
      document.querySelectorAll('[data-weight]').forEach(c => c.classList.remove('selected'));
      $('n-gender').disabled = true; $('n-gender').style.opacity = '.4';
      $('n-weight').disabled = true; $('n-weight').style.opacity = '.4';
      $('s-login').classList.add('slide-in');
      current = 'login';
      updateChrome();
      $('pw').value = '';
    }

    // â”€â”€ Result â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showResult() {
      const r = calc();
      const tier = getTier(r.result);
      go('result', 'forward');
      setTimeout(() => {
        confetti();
        animateNumber($('resNum'), r.result);
        $('resRaw').textContent = 'Uafrundet: ' + r.raw;
        $('resultIcon').textContent = tier.icon;
        $('tierName').textContent = tier.name;
        $('tierDesc').textContent = tier.desc;
      }, 250);
    }

    // â”€â”€ Button ripple effect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        const rect = this.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        this.style.setProperty('--x', x + '%');
        this.style.setProperty('--y', y + '%');
      });
    });

    // â”€â”€ Wire up â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    $('unlockBtn').onclick = tryUnlock;
    $('pw').onkeydown = e => { if (e.key === 'Enter') { e.preventDefault(); tryUnlock(); } };
    $('lockBtn').onclick = lock;

    // â”€â”€ Validation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function invalidate(...ids) {
      let anyInvalid = false;
      let firstInvalid = null;
      ids.forEach(id => {
        const el = $(id);
        if (!el) return;
        const empty = !parseNum(el.value) && el.value.trim() === '';
        if (empty) {
          anyInvalid = true;
          // Remove then re-add so animation re-triggers
          el.classList.remove('invalid');
          requestAnimationFrame(() => el.classList.add('invalid'));
          el.addEventListener('animationend', () => el.classList.remove('invalid'), { once: true });
          if (!firstInvalid) firstInvalid = el;
        }
      });
      if (anyInvalid) {
        haptic('heavy');
        firstInvalid?.focus();
      }
      return anyInvalid;
    }

    // Food cells need slightly different handling (the cell, not the input)
    function invalidateFood(...ids) {
      let anyInvalid = false;
      ids.forEach(id => {
        const input = $(id);
        if (!input) return;
        const cell = input.closest('.food-cell') || input;
        const empty = input.value.trim() === '';
        if (empty) {
          anyInvalid = true;
          cell.classList.remove('invalid');
          requestAnimationFrame(() => cell.classList.add('invalid'));
          cell.addEventListener('animationend', () => cell.classList.remove('invalid'), { once: true });
        }
      });
      if (anyInvalid) haptic('heavy');
      return anyInvalid;
    }

    // â”€â”€ Gender selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.querySelectorAll('[data-gender]').forEach(card => {
      card.addEventListener('click', () => {
        haptic();
        selectedGender = card.dataset.gender;
        document.querySelectorAll('[data-gender]').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        const btn = $('n-gender');
        btn.disabled = false;
        btn.style.opacity = '1';
      });
    });

    $('n-gender').onclick = () => {
      if (!selectedGender) return;
      haptic();
      if (selectedGender === 'kvinde') {
        // Special path: show result 20 with Kvinde tier
        selectedWeight = 1.00;
        const tier = { icon: 'ğŸª', name: 'Dameteltet pÃ¥ dÃ¸lle', desc: 'Gi\' den gas!' };
        go('result', 'forward');
        setTimeout(() => {
          confetti();
          animateNumber($('resNum'), 20);
          $('resRaw').textContent = '';
          $('resultIcon').textContent = tier.icon;
          $('tierName').textContent = tier.name;
          $('tierDesc').textContent = tier.desc;
        }, 250);
      } else {
        go('weight', 'forward');
      }
    };

    // â”€â”€ Weight selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.querySelectorAll('[data-weight]').forEach(card => {
      card.addEventListener('click', () => {
        haptic();
        selectedWeight = parseFloat(card.dataset.weight);
        weightChosen = true;
        document.querySelectorAll('[data-weight]').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        const btn = $('n-weight');
        btn.disabled = false;
        btn.style.opacity = '1';
      });
    });

    $('b-weight').onclick = () => go('gender', 'back');
    $('n-weight').onclick = () => { if (weightChosen) go('1', 'forward'); };

    $('n1').onclick = () => { if (!invalidate('vol')) go('2','forward'); };
    $('n2').onclick = () => { if (!invalidate('ath','atm')) go('3','forward'); };
    $('n3').onclick = () => { if (!invalidate('sleep')) go('4','forward'); };
    $('n4').onclick = () => { if (!invalidateFood('meat','bread','greens','fruit') && !invalidate('liquid')) go('5','forward'); };
    $('n5').onclick = () => { if (!invalidate('water')) showResult(); };

    $('b2').onclick = () => go('1','back');
    $('b3').onclick = () => go('2','back');
    $('b4').onclick = () => go('3','back');
    $('b5').onclick = () => go('4','back');

    $('shareBtn').onclick = () => {
      haptic();
      const icon = $('resultIcon').textContent;
      const num  = $('resNum').textContent;
      const name = $('tierName').textContent;
      const desc = $('tierDesc').textContent;
      const text = `${icon} Bajer Score: ${name}\n${num} genstande\n"${desc}"`;
      if (navigator.share) {
        navigator.share({ text }).catch(() => {});
      } else {
        navigator.clipboard?.writeText(text).then(() => {
          const btn = $('shareBtn');
          btn.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><polyline points="20 6 9 17 4 12"/></svg>`;
          setTimeout(() => {
            btn.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>`;
          }, 2000);
        });
      }
    };

    $('restartBtn').onclick = () => {
      haptic();
      ['vol','ath','atm','sleep','meat','bread','greens','fruit','liquid','water'].forEach(id => $(id).value = '');
      // Reset gender + weight
      selectedGender = null; selectedWeight = 1.00; weightChosen = false;
      document.querySelectorAll('[data-gender]').forEach(c => c.classList.remove('selected'));
      document.querySelectorAll('[data-weight]').forEach(c => c.classList.remove('selected'));
      $('n-gender').disabled = true; $('n-gender').style.opacity = '.4';
      $('n-weight').disabled = true; $('n-weight').style.opacity = '.4';
      go('gender','back');
    };
    $('editBtn').onclick = openModal;

    // Enter key navigation
    $('vol').onkeydown    = e => { if (e.key==='Enter') { e.preventDefault(); $('n1').click(); } };
    $('ath').onkeydown    = e => { if (e.key==='Enter') { e.preventDefault(); $('atm').focus(); } };
    $('atm').onkeydown    = e => { if (e.key==='Enter') { e.preventDefault(); $('n2').click(); } };
    $('sleep').onkeydown  = e => { if (e.key==='Enter') { e.preventDefault(); $('n3').click(); } };
    $('liquid').onkeydown = e => { if (e.key==='Enter') { e.preventDefault(); $('n4').click(); } };
    $('water').onkeydown  = e => { if (e.key==='Enter') { e.preventDefault(); $('n5').click(); } };

    // â”€â”€ Auto-unlock â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    if (localStorage.getItem(KEY) === '1') {
      $('s-login').classList.remove('slide-in');
      $('s-gender').classList.add('slide-in');
      current = 'gender';
      updateChrome();
    }
  })();
  </script>
</body>
</html>
